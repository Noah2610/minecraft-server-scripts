#!/bin/bash
# Starts the minecraft server.

source "$( dirname "$0" )/lib.sh"

print_date

check_dir "${SERVER_DIR}"
cd "${SERVER_DIR}"

[ -f "${SERVER_JAR}" ] \
    || err "Missing server jar file: ${SERVER_JAR}"

if [ -n "$ARG_ACCEPT_EULA" ]; then
    msg "Accepting minecraft EULA..."
    if [ -f ./eula.txt ]; then
        try_run \
            sed -i s/eula=false/eula=true/ eula.txt
    else
        echo "eula=true" > eula.txt
    fi
fi

msg "Starting server..."

try_run \
    java ${JAVA_ARGS} -jar "${SERVER_JAR}" nogui
